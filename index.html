<!DOCTYPE html>
<html lang="lb">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>P4 – Ausso bauen</title>

<style>
@font-face{
  font-family:'Schoulschrëft';
  src:url('https://raw.githubusercontent.com/albrechtclaire1007/schoulschreft/main/schoulschreft_bold%5B2%5D.TTF') format('truetype');
  font-weight:bold;
}

:root{
  --bg:#ebe3ff;
  --ink:#2d1844;
  --subj:#b7f0c8;
  --verb:#e6dcff;
  --gar:#ffd9c4;
  --box:#ffffff;
  --ok:#2f8f4e;
  --bad:#b02323;
}

*{box-sizing:border-box}

body{
  margin:0;
  padding:18px;
  font-family:'Schoulschrëft', system-ui, sans-serif;
  background:var(--bg);
  color:var(--ink);
}

h1{
  text-align:center;
  font-size:1.6rem;
  margin-bottom:10px;
}

.instruction{
  max-width:1000px;
  margin:0 auto 16px;
  background:var(--box);
  border-radius:18px;
  padding:14px;
  text-align:center;
  font-size:1.2rem;
}

/* SENTENCE ROW */
.row{
  display:flex;
  align-items:flex-end;
  justify-content:space-between;
  gap:12px;
  max-width:1100px;
  margin:0 auto;
}

.slotWrap{
  flex:1;
  display:flex;
  flex-direction:column;
  align-items:center;
}

.slot{
  width:100%;
  min-height:72px;
  background:#fff;
  border-radius:18px;
  border:2px dashed rgba(0,0,0,.25);
  display:flex;
  align-items:center;
  justify-content:center;
  font-size:1.5rem;
}

.slot.filled{
  border-style:solid;
}

.pos{
  margin-top:4px;
  font-size:1rem;
  opacity:.6;
}

.dot{
  font-size:2.2rem;
  padding-bottom:8px;
}

/* BANK */
.bank{
  display:flex;
  justify-content:center;
  gap:14px;
  flex-wrap:wrap;
  margin:18px auto;
  max-width:1100px;
}

.pill{
  padding:12px 22px;
  border-radius:999px;
  font-size:1.4rem;
  border:2px solid rgba(0,0,0,.08);
  cursor:grab;
  user-select:none;
}

.subj{background:var(--subj)}
.verb{background:var(--verb)}
.gar{background:var(--gar)}

.controls{
  display:flex;
  justify-content:center;
  gap:12px;
  margin-top:10px;
}

button{
  font-family:'Schoulschrëft';
  font-size:1.2rem;
  padding:10px 18px;
  border-radius:999px;
  border:2px solid var(--ink);
  background:#fff;
  cursor:pointer;
}

.feedback{
  text-align:center;
  min-height:1.5em;
  margin-top:10px;
  font-size:1.3rem;
}
.feedback.ok{color:var(--ok)}
.feedback.bad{color:var(--bad)}
</style>
</head>

<body>

<h1>Ausso bauen</h1>

<div class="instruction">
Lies d’Wierder a bau eng <strong>Ausso</strong>.  
Zéi d'Sazdeeler an déi richteg Reiefolleg.
</div>

<div class="row">
  <div class="slotWrap">
    <div class="slot" data-slot="1"></div>
    <div class="pos">1</div>
  </div>
  <div class="slotWrap">
    <div class="slot" data-slot="2"></div>
    <div class="pos">2</div>
  </div>
  <div class="slotWrap">
    <div class="slot" data-slot="3"></div>
    <div class="pos">3</div>
  </div>
  <div class="dot">.</div>
</div>

<div class="bank" id="bank"></div>

<div class="controls">
  <button id="check">Kontrolléieren</button>
  <button id="next">Nächst</button>
</div>

<div class="feedback" id="fb"></div>

<script>
/* ================= DATA ================= */

const VERBS = [
  "lauschteren","kucken","liesen","schwammen","lafen","danzen",
  "maachen","spillen","telefonéieren","raschten","kachen","boxen",
  "léieren","spadséieren","molen"
];

const EXAMPLES = [];
while(EXAMPLES.length < 30){
  EXAMPLES.push({
    pron:"ech",
    verb:VERBS[Math.floor(Math.random()*VERBS.length)],
    gar:Math.random()<.5 ? "gär" : "net gär"
  });
}

/* ================= CONJUGATION ================= */

function stemOf(inf){
  return inf.endsWith("en") ? inf.slice(0,-2) : inf;
}

function conjEchBase(inf){
  return stemOf(inf)+"en";
}

/* -n rule incl. net gär */
function applyNRule(form, nextWord){
  if(form.endsWith("en") && !nextWord.startsWith("n")){
    return form.slice(0,-1);
  }
  return form;
}

function conjEch(inf, gar){
  return applyNRule(conjEchBase(inf), gar);
}

/* ================= GAME STATE ================= */

let pos = 0;
let current = null;
let placed = {1:null,2:null,3:null};

const slots = document.querySelectorAll(".slot");

/* ================= DRAG ================= */

slots.forEach(s=>{
  s.addEventListener("dragover", e=>e.preventDefault());
  s.addEventListener("drop", e=>{
    const data = JSON.parse(e.dataTransfer.getData("text"));
    s.textContent = data.text;
    s.classList.add("filled");
    placed[s.dataset.slot] = data.type;
    document.querySelector(`[data-id="${data.id}"]`)?.remove();
  });
});

function makePill(text, cls, type, id){
  const p = document.createElement("div");
  p.className = `pill ${cls}`;
  p.textContent = text;
  p.dataset.id = id;
  p.draggable = true;
  p.addEventListener("dragstart", e=>{
    e.dataTransfer.setData("text", JSON.stringify({text,type,id}));
  });
  return p;
}

/* ================= RENDER ================= */

function loadRound(){
  current = EXAMPLES[pos];
  placed = {1:null,2:null,3:null};
  document.getElementById("fb").textContent = "";

  slots.forEach(s=>{
    s.textContent="";
    s.classList.remove("filled");
  });

  const bank = document.getElementById("bank");
  bank.innerHTML="";

  const verbForms = [
    conjEch(current.verb, current.gar),
    stemOf(current.verb)+"s",
    stemOf(current.verb)+"t"
  ];

  let verbIndex = 0;
  const verbPill = makePill(verbForms[0],"verb","verb","v");

  verbPill.onclick = ()=>{
    verbIndex = (verbIndex+1)%verbForms.length;
    verbPill.textContent = verbForms[verbIndex];
  };

  bank.appendChild(makePill("ech","subj","subj","s"));
  bank.appendChild(verbPill);
  bank.appendChild(makePill(current.gar,"gar","gar","g"));
}

/* ================= CHECK ================= */

document.getElementById("check").onclick = ()=>{
  const ok =
    placed[1]==="subj" &&
    placed[2]==="verb" &&
    placed[3]==="gar";

  document.getElementById("fb").textContent =
    ok ? "Richteg!" : "Nach net ganz.";
  document.getElementById("fb").className =
    "feedback "+(ok?"ok":"bad");
};

document.getElementById("next").onclick = ()=>{
  pos = (pos+1)%EXAMPLES.length;
  loadRound();
};

loadRound();
</script>

</body>
</html>

